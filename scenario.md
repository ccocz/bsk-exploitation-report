Włamywacz komputerowy na zaatakowanym komputerze instaluje program nmap i za jego pomocą skanuje sieć wewnętrzną firmy, do której jest podłączony zaatakowany komputer. W trakcie tego skanowania udaje mu się znaleźć maszynę, na której zainstalowany jest serwer WWW Apache 2 i phpMyAdmin. Łączy się z tym ostatnim i wypróbowuje kilka typowych par login-hasło, żeby dostać się do bazy Green Forest Banku. Udaje mu się znaleźć parę, pozwalającą na wejście do systemu. Po zalogowaniu włamywacz ściąga zawartość bazy danych i ją kasuje.

# Timeline

Before running any of the comments below check if checksums agree with the real sums, e.g.,:

* greenforestbank-router.pcap 

`diff <(openssl dgst -sha256 greenforestbank-router.pcap | cut -d' ' -f2) <(echo "4f341625b1538cb346c4802ce02c75dd55c4430c64cebfbed4a70216fff5bf95")`
`diff <(openssl dgst -ripemd160 greenforestbank-router.pcap | cut -d' ' -f2) <(echo "24b85f7e0be6b1abcd66fa7f2a883752a58c1c70")`

* greenforestbank-serwer.pcap
`diff <(openssl dgst -sha256 greenforestbank-serwer.pcap | cut -d' ' -f2) <(echo "e8fd832714507166dd558c9e6bbd300cee8a66a32f48e2db191488000402e5c0")`
`diff <(openssl dgst -ripemd160 greenforestbank-serwer.pcap | cut -d' ' -f2) <(echo "f77dabe77ff0390ff598ec96d706132b19537776")`

* access.log
`diff <(openssl dgst -sha256 access.log | cut -d' ' -f2) <(echo "30e325f69de2e37b96263fb59a9b8169cd6ea1a160ee9022f7d0a0c782616c75")`
`diff <(openssl dgst -ripemd160 access.log | cut -d' ' -f2) <(echo "4b3389fce7565727469c8c5f7715da3c023356be")`

* auth.log
`diff <(openssl dgst -sha256 auth.log | cut -d' ' -f2) <(echo "fc9195a33f274ac57ed236f5ff1abd462abb2ad3e290c91f799987291fa187d4")`
`diff <(openssl dgst -ripemd160 auth.log | cut -d' ' -f2) <(echo "1dfd36235e561815dd22cbdffad56cfa2a5f7d55")`

## 1) Scanning internal network

Attacker at `15:15:18 (here and below UTC+1)` runs `nmap` in the machine with IP address `172.16.0.2` and discovers `Apache2` and `phpMyAdmin` server with IP 
`192.168.1.2`. This can be proved by running following command on packets' capture on the router:

`tcpdump -i any -r greenforestbank-router.pcap src host 172.16.0.2 | head -n 100`

gives output of:

`
15:15:18.264158 wlp2s0 In  IP 172.16.0.2 > 192.168.0.1: ICMP echo request, id 19245, seq 0, length 8
15:15:18.264159 wlp2s0 In  IP 172.16.0.2 > 192.168.0.2: ICMP echo request, id 543, seq 0, length 8
15:15:18.264160 wlp2s0 In  IP 172.16.0.2 > 192.168.0.3: ICMP echo request, id 29538, seq 0, length 8
15:15:18.264160 wlp2s0 In  IP 172.16.0.2 > 192.168.0.4: ICMP echo request, id 34308, seq 0, length 8
15:15:18.264160 wlp2s0 In  IP 172.16.0.2 > 192.168.0.5: ICMP echo request, id 35468, seq 0, length 8
15:15:18.264160 wlp2s0 In  IP 172.16.0.2 > 192.168.0.6: ICMP echo request, id 11810, seq 0, length 8
15:15:18.264161 wlp2s0 In  IP 172.16.0.2 > 192.168.0.7: ICMP echo request, id 30859, seq 0, length 8
15:15:18.264161 wlp2s0 In  IP 172.16.0.2 > 192.168.0.8: ICMP echo request, id 16715, seq 0, length 8
15:15:18.264175 virbr0 Out IP 172.16.0.2 > 192.168.0.1: ICMP echo request, id 19245, seq 0, length 8
15:15:18.264195 virbr0 Out IP 172.16.0.2 > 192.168.0.2: ICMP echo request, id 543, seq 0, length 8
...
`

From the output, we can see that ICMP ping is used to locate hosts in the internal network.

## 2) Connecting to phpMyAdmin
At `15:24:16` `nmap` reveals IP `192.168.1.2` of the host where `Apache2` server is running. Attacker establishes connection to the host and tries to find proper URL for `phpMyAdmin`. 

``


# System time

# Privillage level
